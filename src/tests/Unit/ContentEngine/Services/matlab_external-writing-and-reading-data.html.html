<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
  <meta xmlns="http://www.w3.org/1999/xhtml" charset="utf-8"></meta>
  <meta xmlns="http://www.w3.org/1999/xhtml" name="viewport" content="width=device-width, initial-scale=1.0"></meta>
  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="X-UA-Compatible" content="IE=edge"></meta>
  <title>Запись и чтение данных</title>
  <script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
        "@type": "ListItem",
        "position": 1,

        "item": {
          "@id": "../index.html",
          "name": "MATLAB"
        }

      }
      ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
            "@id": "../data-import-and-analysis.html",
            "name": "Data Import and Analysis"
          }

        }
      ,
        {
          "@type": "ListItem",
          "position": 3,

          "item": {
            "@id": "../data-import-and-export.html",
            "name": "Data Import and Export"
          }

        }
      ,
        {
          "@type": "ListItem",
          "position": 4,

          "item": {
            "@id": "../serial-port-devices.html",
            "name": "Serial Port Devices"
          }

        }]
    }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "ItemList",
    "name": "VisibleBreadcrumbs",

    "itemListElement":
    [
      "serial-port-devices"
    ],
    "itemListOrder": "http://schema.org/ItemListOrderAscending"
  }
</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "PropertyValue",
    "name": "UISupport",
    "value": "Desktop"

  }</script><link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css"></link>


  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Script-Type" content="text/javascript"></meta>
  <meta xmlns="http://www.w3.org/1999/xhtml" name="toctype" itemprop="pagetype" content="ug"></meta>
  <meta xmlns="http://www.w3.org/1999/xhtml" name="infotype" itemprop="infotype" content="ex"></meta>

  <meta xmlns="http://www.w3.org/1999/xhtml" name="description" itemprop="description" content="You can write data to the device and read data from the device."></meta><script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" src="../../includes/product/scripts/jquery/jquery-latest.js"></script>
  <link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6.css?201808230603" rel="stylesheet" type="text/css"></link>
  <link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_lg.css?201808230603" rel="stylesheet" media="screen and (min-width: 1200px)"></link>
  <link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_md.css?201808230603" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)"></link>
  <link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm+xs.css?201808230603" rel="stylesheet" media="screen and (max-width: 991px)"></link>
  <link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm.css?201808230603" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)"></link>
  <link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_xs.css?201808230603" rel="stylesheet" media="screen and (max-width: 767px)"></link>
  <link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_offcanvas.css?201808230603" rel="stylesheet" type="text/css"></link>

  <script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/l10n.js"></script>
  <script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/docscripts.js"></script>
  <script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/f1help.js"></script>
  <script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/docscripts.js"></script>
  <script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/mw.imageanimation.js"></script>
  <script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/jquery.highlight.js"></script>
  <script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/underscore-min.js"></script>
  <script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/examples.js"></script>
  <script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/use_platform_screenshots.js"></script>
  <script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/suggest.js"></script>
  <script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/overload.js"></script>
  <script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/helpservices.js"></script>





  <script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
  <script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/bootstrap.min.js" type="text/javascript"></script>
  <script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/global.js"></script>
  <link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_base.css" rel="stylesheet" type="text/css"></link>
  <link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css"></link>
  <link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print"></link>
  <script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" src="../../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div xmlns="http://www.w3.org/1999/xhtml" id="doc_header_spacer" class="header"></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="sticky_header_container includes_subnav affix-top"><div class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-xs-12 has_horizontal_local_nav" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../../documentation-center.html">Документация</a></h1></div><button type="button" class="navbar-toggle collapsed subnav visible-xs" data-toggle="collapse" data-target=".mobile_subnav_content"><span class="icon-arrow-down icon_24"></span></button></div><div class="crux_nav_container hidden-xs"><div class="crux_nav"><ul id="topnav_main"><li id="crux_nav_documentation" class="crux_nav_active"><a>Все</a></li><li id="crux_nav_example"><a href="../examples.html?category=serial-port-devices">Примеры</a></li><li id="crux_nav_function"><a href="../referencelist.html?type=function&amp;category=serial-port-devices">Функции</a></li><li role="presentation" class="dropdown" id="topnav_more" style="display:none;"><a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false"> Больше <span class="caret"></span></a><ul class="dropdown-menu"></ul></li></ul></div></div></div><div class="col-xs-12" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2018b" data-language="en" action="../../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="sr-only">Справка по поиску</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"> </input><div class="input-group-btn"><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search pull-right icon_32 visible-xs" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="visible-xs" id="search_actuator"><button class="btn icon-search btn_search pull-right icon_16" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div><div class="row visible-xs" id="mobile_subnav"><div class="col-xs-12"><div class="navbar-collapse collapse mobile_subnav_content"><div class="crux_nav_container"><div class="crux_nav"><ul class="nav navbar-nav subnav"><li id="crux_nav_documentation" class="crux_nav_active"><a>Все</a></li><li id="crux_nav_example"><a href="../examples.html?category=serial-port-devices">Примеры</a></li><li id="crux_nav_function"><a href="../referencelist.html?type=function&amp;category=serial-port-devices">Функции</a></li></ul></div></div></div></div></div></div></div><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_actuator" data-toggle="offcanvas" data-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="sr-only">Навигация</span><span class="icon-menu"></span></button><span class="offcanvas_actuator_label" id="translation_icon-filter" tabindex="0"></span><span class="offcanvas_actuator_close" tabindex="0"></span></div><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-md-12 hidden-xs hidden-sm"></div></div></div></div></div></div></div><div class="row-offcanvas row-offcanvas-left">
  <div xmlns="http://www.w3.org/1999/xhtml" class="sidebar-offcanvas" id="sidebar" role="navigation">
    <nav class="offcanvas_nav" role="navigation">
      <ul class="nav_breadcrumb"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../documentation-center.html" itemprop="url"><span itemprop="title">Домашняя страница документации</span></a></li></ul>
      <ul class="nav_disambiguation"><li><a href="../index.html">MATLAB</a>
      </li>
        <li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../data-import-and-analysis.html" itemprop="url"><span itemprop="title">Импорт и анализ данных</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../data-import-and-export.html" itemprop="url"><span itemprop="title">Импорт и экспорт данных</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../serial-port-devices.html" itemprop="url"><span itemprop="title">Устройства последовательного порта</span></a></li></ul><ul class="nav_scrollspy nav">
      <li class="nav_scrollspy_function"><a href="#responsive_offcanvas">Запись и чтение данных</a></li>
      <li class="nav_scrollspy_title" id="SSPY810-section">На этой странице</li>
      <!--ADD_REFENTRY_TITLE_HERE 11--><li><a href="#f92328" class="intrnllnk">Прежде чем вы начнете</a></li><li><a href="#bq__6qz-1" class="intrnllnk">Пример - введение в запись и чтение данных</a></li><li><a href="#f62883" class="intrnllnk">Управление доступом к командной строке MATLAB</a></li><li><a href="#f71503" class="intrnllnk">Запись данных</a><ul class="nav"><li><a href="#f69691" class="intrnllnk">Буфер вывода и поток данных</a></li><li><a href="#f68507" class="intrnllnk">Запись текстовых данных</a></li><li><a href="#f62932" class="intrnllnk">Запись двоичных данных</a></li><li><a href="#br8zt6b-1" class="intrnllnk">Распространенные ошибки Поиска и устранения проблем</a></li></ul></li><li><a href="#f62939" class="intrnllnk">Чтение данных</a><ul class="nav"><li><a href="#f71755" class="intrnllnk">Входной буфер и поток данных</a></li><li><a href="#f123662" class="intrnllnk">Чтение текстовых данных</a></li><li><a href="#f72926" class="intrnllnk">Чтение двоичных данных</a></li></ul></li><li><a href="#f63007" class="intrnllnk">Пример - пишущие и считывающие текстовые данные</a></li><li><a href="#f97378" class="intrnllnk">Пример - Парсинг Входных данных Используя textscan</a></li><li><a href="#f97373" class="intrnllnk">Пример - считывающий двоичные данные</a><ul class="nav"><li><a href="#f97208" class="intrnllnk">Просмотр растровых данных</a></li></ul></li></ul>
    </nav>
    <script src="../../includes/product/scripts/offcanvas.js"></script></div><!--END.CLASS sidebar-offcanvas-->
  <div class="content_container" id="content_container" itemprop="content">
    <div class="container-fluid">
      <div class="row">
        <div class="col-xs-12">

          <section xmlns="http://www.w3.org/1999/xhtml" id="doc_center_content" lang="en"><div id="pgtype-topic">
            <section itemprop="content"><h2 class="title r2018b" itemprop="title content" id="f62852">Запись и чтение данных</h2><a class="indexterm" name="d120e79704"></a><section itemprop="content"><h3 class="title" id="f92328">Прежде чем вы начнете</h3><p>Для многих приложений последовательного порта существует три важных вопроса, которые необходимо рассмотреть при записи или чтении данных:</p><div class="itemizedlist"><ul><li><p>Будет чтение или писать доступ к функциональному блоку к командной строке <sup>MATLAB®</sup>?</p></li><li><p>Данные должны быть переданы (числовой) двоичный файл или текст?</p></li><li><p>При каких условиях операция чтения или операция записи завершатся?</p></li></ul></div><p>Для операций записи на эти вопросы отвечают в <a href="writing-and-reading-data.html#f71503" class="intrnllnk">Записи данных</a>. Для операций чтения на эти вопросы отвечают в <a href="writing-and-reading-data.html#f62939" class="intrnllnk">Чтении Данных</a>.</p></section><section itemprop="content"><h3 class="title" id="bq__6qz-1">Пример - введение в запись и чтение данных</h3><p>Предположим, что вы хотите возвратить идентификационную информацию для <sup>Tektronix® TDS 210</sup> двухканальный осциллограф, соединенный с последовательным портом COM1 на платформе <sup>Windows®</sup>. Это требует записи команды <code class="literal">*IDN?</code> к инструменту с помощью функции <a href="../ref/serial.fprintf.html"><code class="function">fprintf</code></a>, и читая назад результат той команды с помощью функции <a href="../ref/serial.fscanf.html"><code class="function">fscanf</code></a>.</p><div class="code_responsive"><pre class="programlisting">s = serial('COM1');
fopen(s)
fprintf(s,'*IDN?')
out = fscanf(s)</pre></div><p>Получившаяся идентификационная информация:</p><div class="code_responsive"><pre class="programlisting">out =
TEKTRONIX,TDS 210,0,CF:91.1CT FV:v1.16 TDS2CM:CMV:v1.04</pre></div><p>Закончите сеанс последовательного порта.</p><div class="code_responsive"><pre class="programlisting">fclose(s)
delete(s)
clear s</pre></div></section><section itemprop="content"><h3 class="title" id="f62883"><span class="trademark entity">Управление доступом к командной строке MATLAB</span></h3><span id="synch_asynch_description" class="anchor_target"></span><p>Вы управляете доступом к командной строке MATLAB путем определения, являются ли операция чтения или операция записи <span class="emphasis"><em>синхронными</em></span> или <span class="emphasis"><em>асинхронными</em></span>.</p><p>Синхронная операция блокирует доступ к командной строке до чтения, или функция записи завершает выполнение. Асинхронная операция не блокирует доступ к командной строке, и можно дать дополнительные команды, в то время как чтение или пишет, что функция выполняется в фоновом режиме.</p><p>Термины<span class="emphasis"><em>, синхронные</em></span> и <span class="emphasis"><em>асинхронные</em></span>, часто используются, чтобы описать, как последовательный порт действует на аппаратном уровне. Стандарт RS-232 поддерживает асинхронный протокол связи. Используя этот протокол, каждое устройство использует свои собственные внутренние часы. Передача данных синхронизируется с помощью старт-бита байтов, в то время как один или несколько стоп-битов указывают на конец байта. Для получения дополнительной информации о старт-битах и стоп-битах, смотрите <a href="overview-of-the-serial-port.html#f52182" class="a">Формат Последовательных данных</a>. Стандарт RS-232 также поддерживает синхронный режим, где все переданные биты синхронизируются с общим сигналом часов.</p><p>На аппаратном уровне большинство последовательных портов действует асинхронно. Однако с помощью поведения по умолчанию для многих из чтения и функций записи, можно подражать операции синхронного последовательного порта.</p><div class="alert alert-info"><span class="alert_icon icon-alert-info-reverse"></span><h3>Примечание</h3><p>Когда используется в этом руководстве, термины<span class="emphasis"><em>, синхронные</em></span> и <span class="emphasis"><em>асинхронные</em></span>, относятся к или операции чтения, или операции записи блокируют доступ к командной строке MATLAB. Другими словами, эти условия описывают, как программное обеспечение ведет себя, и не то, как аппаратные средства ведут себя.</p></div><p>Два основных преимущества записи или чтения данных асинхронно: </p><div class="itemizedlist"><ul><li><p>Можно дать другую команду, в то время как запись или читала, функция выполняется.</p></li><li><p>Можно использовать все поддерживаемые свойства обратного вызова (см. <a href="events-and-callbacks.html" class="a">События и Обратные вызовы</a>).</p></li></ul></div><p>Например, потому что последовательные порты имеют отдельное чтение и контакты записи, можно одновременно читать и записать данные. Это проиллюстрировано в следующей схеме.</p><div class="informalfigure"><div id="d120e79822" class="mediaobject"><p><img src="ch_serialtut10.gif" alt="" height="114" width="481"></img></p></div></div></section><section itemprop="content"><h3 class="title" id="f71503">Запись данных</h3><p>В этом разделе описываются записывание данные к вашему устройству последовательного порта в трех частях:</p><div class="itemizedlist"><ul><li><p><a href="writing-and-reading-data.html#f69691" class="intrnllnk">Буфер вывода и Поток данных</a> описывают поток данных с программного обеспечения MATLAB на устройство.</p></li><li><p><a href="writing-and-reading-data.html#f68507" class="intrnllnk">Запись текстовых Данных</a> описывает, как записать текстовые данные (команды строки) к устройству.</p></li><li><p><a href="writing-and-reading-data.html#f62932" class="intrnllnk">Запись Двоичных данных</a> описывает, как записать бинарные (числовые) данные в устройство.</p></li></ul></div><p>Следующая таблица показывает функции, сопоставленные с записыванием данные.</p><div itemprop="content" id="d120e79848" class="table_class"><p class="title"><strong id="f68080" class="title">Функции, связанные с Записью данных</strong></p><div class="table-responsive"><table class="table table-condensed" summary="Functions Associated with Writing Data"><colgroup><col class="tcol1" width="26%"></col><col class="tcol2" width="74%"></col></colgroup><thead><tr><th>FunctionName </th><th>Описание</th></tr></thead><tbody><tr><td><p><a href="../ref/serial.fprintf.html"><code class="function">fprintf</code></a></p></td><td><p>Запишите текст в устройство</p></td></tr><tr><td><p><a href="../ref/serial.fwrite.html"><code class="function">fwrite</code></a></p></td><td><p>Запишите двоичные данные в устройство</p></td></tr><tr><td><p><a href="../ref/stopasync.html"><code class="function">stopasync</code></a></p></td><td><p>Остановите асинхронные операции чтения и операции записи</p></td></tr></tbody></table></div></div><p>Следующая таблица показывает свойства, сопоставленные с записыванием данные.</p><div itemprop="content" id="d120e79887" class="table_class"><p class="title"><strong id="f68677" class="title">Свойства, связанные с Записью данных</strong></p><div class="table-responsive"><table class="table table-condensed" summary="Properties Associated with Writing Data"><colgroup><col class="tcol1" width="30%"></col><col class="tcol2" width="70%"></col></colgroup><thead><tr><th>PropertyName </th><th>Описание</th></tr></thead><tbody><tr><td><p><a href="../ref/serialport-properties.html#mw_f17748a9-362b-49b4-8369-ec9a133b5ac0" class="a">BytesToOutput</a></p></td><td><p>Количество байтов в настоящее время в буфере вывода</p></td></tr><tr><td><p><a href="../ref/serialport-properties.html#mw_f12b6a94-309a-4c7b-a160-f585876d0b35" class="a">OutputBufferSize</a></p></td><td><p>Размер буфера вывода в байтах</p></td></tr><tr><td><p><a href="../ref/serialport-properties.html#mw_84c0a974-300b-4687-bf11-c8f7aa4d27b0" class="a">Тайм-аут</a></p></td><td><p>Время ожидания, чтобы завершить операцию чтения или операцию записи</p></td></tr><tr><td><p><a href="../ref/serialport-properties.html#mw_cadb0fea-a824-401a-bb7d-a214b04a9e35" class="a">TransferStatus</a></p></td><td><p>Укажите, происходят ли асинхронная операция чтения или операция записи</p></td></tr><tr><td><p><a href="../ref/serialport-properties.html#mw_a39c3070-5e92-4e63-aeb4-f40f11649ba4" class="a">ValuesSent</a></p></td><td><p>Общее количество значений записано в устройство</p></td></tr></tbody></table></div></div><section itemprop="content"><h4 class="title" id="f69691">Буфер вывода и поток данных</h4><a class="indexterm" name="d120e79938"></a><a class="indexterm" name="d120e79943"></a><p>Буфер вывода является памятью компьютера, выделенной объектом последовательного порта хранить данные, который должен быть записан в устройство. При записывании данные к устройству поток данных выполняет эти два шага:</p><div class="orderedlist"><ol style="list-style: decimal;"><li><p id="f97157">Данные, заданные функцией записи, отправляются в буфер вывода.</p></li><li><p id="f97158">Данные в буфере вывода отправляются в устройство.</p></li></ol></div><p>Свойство <code class="literal">OutputBufferSize</code> задает максимальное количество байтов, которые можно сохранить в буфере вывода. Свойство <code class="literal">BytesToOutput</code> указывает на количество байтов в настоящее время в буфере вывода. Значения по умолчанию для этих свойств:</p><div class="code_responsive"><pre class="programlisting">s = serial('COM1');
get(s,{'OutputBufferSize','BytesToOutput'})
ans =
    [512]    [0]</pre></div><p>При попытке записать больше данных, чем может поместиться в буфер вывода, ошибка возвращена, и никакие данные записан.</p><p>Например, предположите, что вы пишете команде строки <code class="literal">*IDN?</code> в осциллограф TDS 210 с помощью функции <a href="../ref/serial.fprintf.html"><code class="function">fprintf</code></a>. Как показано в следующей схеме, строка сначала записана в буфер вывода как шесть значений.</p><div class="informalfigure"><div id="d120e79978" class="mediaobject"><p><img src="ch_serialtut2.gif" alt="" height="179" width="350"></img></p></div></div><p>Команда <code class="literal">*IDN?</code> состоит из шести значений, потому что терминатор строки автоматически записан. Кроме того, формат данных по умолчанию для функции <code class="function">fprintf</code> указывает, что одно значение соответствует одному байту. Для получения дополнительной информации о байтах и значениях, смотрите <a href="overview-of-the-serial-port.html#f60291" class="a">Байты По сравнению со Значениями</a>. <code class="function">fprintf</code> и терминатор строки обсуждены в <a href="writing-and-reading-data.html#f68507" class="intrnllnk">записи текстовых Данных</a>.</p><p>Как показано в следующей схеме, после того, как строка записана в буфер вывода, это затем записано в устройство через последовательный порт.</p><div class="informalfigure"><div id="d120e80000" class="mediaobject"><p><img src="ch_serialtut14.gif" alt="" height="176" width="480"></img></p></div></div></section><section itemprop="content"><h4 class="title" id="f68507">Запись текстовых данных</h4><a class="indexterm" name="d120e80006"></a><a class="indexterm" name="d120e80011"></a><a class="indexterm" name="d120e80016"></a><p>Вы используете функцию <a href="../ref/serial.fprintf.html"><code class="function">fprintf</code></a>, чтобы записать текстовые данные в устройство. Для многих устройств, пишущий текстовые данные означает писать команды строки, которые изменяют настройки устройства, готовят устройство, чтобы возвратить данные или информацию о статусе и так далее.</p><p>Например, команда <code class="literal">Display:Contrast</code> изменяет контрастность дисплея осциллографа.</p><div class="code_responsive"><pre class="programlisting">s = serial('COM1');
fopen(s)
fprintf(s,'Display:Contrast 45')</pre></div><p>По умолчанию <code class="function">fprintf</code> записывает данные с помощью формата <code class="literal">%s\n</code>, потому что много устройств последовательного порта принимают только основанные на тексте команды. Однако можно задать много других форматов, как описано на страницах с описанием <a href="../ref/serial.fprintf.html"><code class="function">fprintf</code></a>.</p><p>Чтобы проверить количество значений, отправленных в устройство, используйте свойство <code class="literal">ValuesSent</code>.</p><div class="code_responsive"><pre class="programlisting">s.ValuesSent
ans =
    20</pre></div><p>Обратите внимание на то, что значение свойства <code class="literal">ValuesSent</code> включает терминатор строки, потому что каждое возникновение <code class="literal">\n</code> в команде, отправленной в устройство, заменяется значением свойства <code class="literal">Terminator</code>.</p><div class="code_responsive"><pre class="programlisting">s.Terminator
ans =
LF</pre></div><p>Значение по умолчанию <code class="property">Terminator</code> является символом перевода строки. Терминатор строки, требуемый вашим устройством, будет описан в его документации.</p><p><strong id="f94638">Синхронный по сравнению с асинхронными операциями записи.&nbsp;&nbsp;</strong>По умолчанию <code class="function">fprintf</code> действует синхронно и блокирует командную строку MATLAB, пока выполнение не завершается. Чтобы записать текстовые данные асинхронно в устройство, необходимо задать <code class="literal">асинхронный</code> как последний входной параметр к <code class="function">fprintf</code>.</p><div class="code_responsive"><pre class="programlisting">fprintf(s,'Display:Contrast 45','async')</pre></div><p>Асинхронные операции не блокируют доступ к командной строке MATLAB. Кроме того, в то время как асинхронная операция записи происходит, вы можете:</p><div class="itemizedlist"><ul><li><p>Выполните асинхронную операцию чтения, потому что последовательные порты имеют отдельные контакты для чтения и записи</p></li><li><p>Используйте все поддерживаемые свойства обратного вызова</p></li></ul></div><p>Чтобы определить, какие асинхронные операции происходят, используйте свойство <code class="literal">TransferStatus</code>. Если никакие асинхронные операции не происходят, <code class="literal">TransferStatus</code> является <code class="literal">idle</code>.</p><div class="code_responsive"><pre class="programlisting">s.TransferStatus
ans =
idle</pre></div><p><strong id="f94797">Завершение Операции записи с fprintf.&nbsp;&nbsp;</strong>Синхронная или асинхронная операция записи с помощью <code class="literal">fprintf</code> завершается когда:</p><div class="itemizedlist"><ul><li><p>Заданные данные записаны.</p></li><li><p><code class="literal">Прошло время, заданное как свойство Timeout.</code></p></li></ul></div><p>Остановите асинхронную операцию записи с функцией <a href="../ref/stopasync.html"><code class="function">stopasync</code></a>.</p><p><strong id="br8pqg6-1">Правила для Записи Терминатора.&nbsp;&nbsp;</strong>Значение свойства <a href="terminator.html"><span class="property"><code class="olink">Terminator</code></span></a> заменяет все случаи <code class="literal">\n</code> в <code class="literal">cmd</code>. Поэтому, когда вы используете формат по умолчанию <code class="literal">%s\n</code>, все команды, записанные в конец устройства с этим значением свойства. Обратитесь к своей документации устройства для терминатора строки, требуемого вашим устройством.</p></section><section itemprop="content"><h4 class="title" id="f62932">Запись двоичных данных</h4><a class="indexterm" name="d120e80157"></a><a class="indexterm" name="d120e80162"></a><a class="indexterm" name="d120e80167"></a><p>Вы используете функцию <a href="../ref/serial.fwrite.html"><code class="function">fwrite</code></a>, чтобы записать двоичные данные в устройство. Запись двоичных данных означает писать численные значения. Типовое приложение для записи двоичных данных включает калибровочные данные записи к инструменту, такие как произвольный генератор формы волны.</p><div class="alert alert-info"><span class="alert_icon icon-alert-info-reverse"></span><h3>Примечание</h3><p>Некоторые устройства последовательного порта принимают только основанные на тексте команды. Эти команды могут использовать язык SCPI или некоторый другой специфичный для поставщика язык. Поэтому вы можете должны быть использовать функцию <a href="../ref/serial.fprintf.html"><code class="function">fprintf</code></a> для всех операций записи.</p></div><p>По умолчанию <code class="function">fwrite</code> переводит значения с помощью точности <code class="literal">uchar</code>. Однако можно задать много другой точности, как описано на страницах с описанием для этой функции.</p><p>По умолчанию <code class="function">fwrite</code> действует синхронно. Чтобы записать двоичные данные асинхронно в устройство, необходимо задать <code class="literal">async</code> как последний входной параметр к <code class="function">fwrite</code>. Для получения дополнительной информации о синхронных и асинхронных операциях записи, смотрите <a href="writing-and-reading-data.html#f68507" class="intrnllnk">текстовые Данные Записи</a>. Для описания правил<a href="../ref/serial.fwrite.html"><code class="function">, использованных fwrite</code></a>, чтобы завершить операцию записи, обратитесь к ее страницам с описанием.</p></section><section itemprop="content"><h4 class="title" id="br8zt6b-1">Распространенные ошибки Поиска и устранения проблем</h4><p>Используйте эту таблицу, чтобы идентифицировать общие ошибки <a href="../ref/serial.fprintf.html"><code class="function">fprintf</code></a>.</p><div class="table-responsive"><table class="table table-condensed"><colgroup><col class="tcol1" width="26%"></col><col class="tcol2" width="37%"></col><col class="tcol3" width="37%"></col></colgroup><thead><tr><th>Ошибка</th><th>Происходит когда</th><th>Поиск и устранение проблем</th></tr></thead><tbody><tr><td><p>??? Ошибка ==&gt; serial.fwrite в 199 Объектах должна быть соединена с аппаратными средствами с FOPEN.</p></td><td><p>Вы выполняете операцию записи, и объект последовательного порта не соединяется с устройством.</p></td><td><p>Используйте <a href="../ref/serial.fopen.html"><code class="function">fopen</code></a>, чтобы установить связь с устройством.</p></td></tr><tr><td><p>??? Ошибка ==&gt; serial.fwrite в 199 количество записанных байтов должна быть меньше чем или равна OutputBufferSize-BytesToOutput.</p></td><td><p>Буфер вывода не может содержать все данные, которые будут записаны.</p></td><td><p>Задайте размер буфера вывода со свойством <code class="literal">OutputBufferSize</code>.</p></td></tr><tr><td><p>??? Ошибка ==&gt; serial.fwrite в 192 FWRITE не может быть названа. FlowControl свойство установлено в 'аппаратные средства' и контакт Clear to Send (CTS) высок. Это могло указать, что последовательное устройство не может быть включено, не может быть соединено или не использует аппаратное квитирование</p></td><td><div class="itemizedlist"><ul><li><p>Вы устанавливаете свойство <code class="literal">FlowControl</code> на последовательном объекте к <code class="literal">hardware</code>.</p></li><li><p>Устройство или не соединяется или подключенное устройство, не утверждает, что это готово получить данные.</p></li></ul></div></td><td><p>Проверьте свое состояние удаленного устройства и настройки управления потоками, чтобы видеть, вызывает ли аппаратное управление потоками ошибки MATLAB.</p></td></tr></tbody></table></div></section></section><section itemprop="content"><h3 class="title" id="f62939">Чтение данных</h3><p>В этом разделе описываются данные чтения из вашего устройства последовательного порта в трех частях:</p><div class="itemizedlist"><ul><li><p><a href="writing-and-reading-data.html#f71755" class="intrnllnk">Входной буфер и Поток данных</a> описывают поток данных от устройства до программного обеспечения MATLAB.</p></li><li><p><a href="writing-and-reading-data.html#f123662" class="intrnllnk">Чтение текстовых Данных</a> описывает, как читать из устройства и отформатировать данные как текст.</p></li><li><p><a href="writing-and-reading-data.html#f72926" class="intrnllnk">Чтение Двоичных Данных</a> описывает, как считать бинарные (числовые) данные из устройства.</p></li></ul></div><p>Следующая таблица показывает функции, сопоставленные с чтением данных.</p><div itemprop="content" id="d120e80302" class="table_class"><p class="title"><strong id="f90753" class="title">Функции, связанные с чтением данных</strong></p><div class="table-responsive"><table class="table table-condensed" summary="Functions Associated with Reading Data"><colgroup><col class="tcol1" width="22%"></col><col class="tcol2" width="79%"></col></colgroup><thead><tr><th>FunctionName </th><th>Описание</th></tr></thead><tbody><tr><td><p><a href="../ref/serial.fgetl.html"><code class="function">fgetl</code></a></p></td><td><p>Считайте одну строку текста от устройства и отбросьте терминатор строки</p></td></tr><tr><td><p><a href="../ref/serial.fgets.html"><code class="function">fgets</code></a></p></td><td><p>Считайте одну строку текста от устройства и включайте терминатор строки</p></td></tr><tr><td><p><a href="../ref/serial.fread.html"><code class="function">fread</code></a></p></td><td><p>Считайте двоичные данные из устройства</p></td></tr><tr><td><p><a href="../ref/serial.fscanf.html"><code class="function">fscanf</code></a></p></td><td><p>Считайте данные из устройства и отформатируйте как текст</p></td></tr><tr><td><p><a href="../ref/readasync.html"><code class="function">readasync</code></a></p></td><td><p>Считайте данные асинхронно из устройства</p></td></tr><tr><td><p><a href="../ref/stopasync.html"><code class="function">stopasync</code></a></p></td><td><p>Остановите асинхронные операции чтения и операции записи</p></td></tr></tbody></table></div></div><p>Следующая таблица показывает свойства, сопоставленные с чтением данных.</p><div itemprop="content" id="d120e80365" class="table_class"><p class="title"><strong id="f71581" class="title">Свойства, связанные с чтением данных</strong></p><div class="table-responsive"><table class="table table-condensed" summary="Properties Associated with Reading Data"><colgroup><col class="tcol1" width="26%"></col><col class="tcol2" width="75%"></col></colgroup><thead><tr><th>PropertyName </th><th>Описание</th></tr></thead><tbody><tr><td><p><a href="../ref/serialport-properties.html#mw_5cb71cd8-783c-4cfd-9dc5-6e4926edcb77" class="a">BytesAvailable</a></p></td><td><p>Количество байтов, доступных во входном буфере</p></td></tr><tr><td><p><a href="../ref/serialport-properties.html#mw_5d33f1bd-97a2-4474-b2ea-8499775ddce4" class="a">InputBufferSize</a></p></td><td><p>Размер входного буфера в байтах</p></td></tr><tr><td><p><a href="../ref/serialport-properties.html#mw_2f3c72b3-0e8a-4c90-9f44-48fd1abe2821" class="a">ReadAsyncMode</a></p></td><td><p>Задайте, является ли асинхронная операция чтения непрерывной или ручной</p></td></tr><tr><td><p><a href="../ref/serialport-properties.html#mw_84c0a974-300b-4687-bf11-c8f7aa4d27b0" class="a">Тайм-аут</a></p></td><td><p>Время ожидания, чтобы завершить операцию чтения или операцию записи</p></td></tr><tr><td><p><a href="../ref/serialport-properties.html#mw_cadb0fea-a824-401a-bb7d-a214b04a9e35" class="a">TransferStatus</a></p></td><td><p>Укажите, происходят ли асинхронная операция чтения или операция записи</p></td></tr><tr><td><p><a href="../ref/serialport-properties.html#mw_4ca53b29-9ba2-4a65-8054-4acfe8973d72" class="a">ValuesReceived</a></p></td><td><p>Общее количество значений считано из устройства</p></td></tr></tbody></table></div></div><section itemprop="content"><h4 class="title" id="f71755">Входной буфер и поток данных</h4><a class="indexterm" name="d120e80423"></a><a class="indexterm" name="d120e80428"></a><p>Входной буфер является памятью компьютера, выделенной объектом последовательного порта хранить данные, который должен быть считан из устройства. При чтении данных из устройства поток данных выполняет эти два шага:</p><div class="orderedlist"><ol style="list-style: decimal;"><li><p id="f97147">Данные, считанные из устройства, хранятся во входном буфере.</p></li><li><p id="f97148">Данные во входном буфере возвращены в переменную MATLAB, заданную функцией чтения.</p></li></ol></div><p>Свойство <code class="literal">InputBufferSize</code> задает максимальное количество байтов, которые можно сохранить во входном буфере. Свойство <code class="literal">BytesAvailable</code> указывает на количество байтов, в настоящее время доступных, чтобы быть считанным из входного буфера. Значения по умолчанию для этих свойств:</p><div class="code_responsive"><pre class="programlisting">s = serial('COM1');
get(s,{'InputBufferSize','BytesAvailable'})
ans =
    [512]    [0]</pre></div><p>При попытке считать больше данных, чем может поместиться во входной буфер, ошибка возвращена, и никакие данные читается.</p><p>Например, предположите, что вы используете функцию <a href="../ref/serial.fscanf.html"><code class="function">fscanf</code></a>, чтобы считать основанный на тексте ответ команды <code class="literal">*IDN?</code>, ранее записанной в осциллограф TDS 210. Как показано в следующей схеме, текстовые данные сначала считаны во входной буфер через последовательный порт.</p><div class="informalfigure"><div id="d120e80466" class="mediaobject"><p><img src="ch_serialtut9.gif" alt="" height="176" width="481"></img></p></div></div><p>Обратите внимание на то, что для данной операции чтения, вы не можете знать количество байтов, возвращенных устройством. Поэтому вы можете должны быть задать свойство <code class="literal">InputBufferSize</code> к достаточно большому значению прежде, чем соединить объект последовательного порта.</p><p>Как показано в следующей схеме, после данных сохранен во входном буфере, она затем передается выходной переменной, заданной <code class="function">fscanf</code>.</p><div class="informalfigure"><div id="d120e80481" class="mediaobject"><p><img src="ch_serialtut16.gif" alt="" height="176" width="344"></img></p></div></div></section><section itemprop="content"><h4 class="title" id="f123662">Чтение текстовых данных</h4><a class="indexterm" name="d120e80487"></a><a class="indexterm" name="d120e80492"></a><a class="indexterm" name="d120e80497"></a><p>Вы используете <a href="../ref/serial.fgetl.html"><code class="function">fgetl</code></a>, <a href="../ref/serial.fgets.html"><code class="function">fgets</code></a> и функции <a href="../ref/serial.fscanf.html"><code class="function">fscanf</code></a>, чтобы считать данные из устройства и отформатировать данные как текст.</p><p>Например, предположите, что вы хотите возвратить идентификационную информацию для осциллографа. Это требует записи команды <code class="literal">*IDN?</code> к инструменту, и затем чтение поддерживает результат той команды.</p><div class="code_responsive"><pre class="programlisting">s = serial('COM1');
fopen(s)
fprintf(s,'*IDN?')
out = fscanf(s)
out =
TEKTRONIX,TDS 210,0,CF:91.1CT FV:v1.16 TDS2CM:CMV:v1.04</pre></div><p>По умолчанию <code class="function">fscanf</code> считывает данные с помощью формата <code class="literal">%c</code>, потому что данные, возвращенные многими устройствами последовательного порта, являются базирующимся текстом. Однако можно задать много других форматов, как описано на страницах с описанием <a href="../ref/serial.fscanf.html"><code class="function">fscanf</code></a>.</p><p>Чтобы проверить количество значений, считанных из устройства — включая терминатор строки, используйте свойство <code class="literal">ValuesReceived</code>.</p><div class="code_responsive"><pre class="programlisting">s.ValuesReceived
ans =
    56</pre></div><p><strong id="f98232">Синхронный По сравнению с Асинхронными Операциями чтения.&nbsp;&nbsp;</strong>Вы задаете, являются ли операции чтения синхронными или асинхронными со свойством <code class="literal">ReadAsyncMode</code>. Можно сконфигурировать <code class="literal">ReadAsyncMode</code> к <code class="literal">continuous</code> или <code class="literal">manual</code>.</p><p>Если <code class="literal">ReadAsyncMode</code> является <code class="literal">continuous</code> (значение по умолчанию), объект последовательного порта постоянно запрашивает устройство, чтобы определить, доступны ли данные, чтобы быть считанными. Если данные доступны, это асинхронно сохранено во входном буфере. Чтобы передать данные от входного буфера до MATLAB, используйте один из синхронных (блокирование) функции чтения, такие как <code class="function">fgetl</code> или <code class="function">fscanf</code>. Если данные доступны во входном буфере, эти функции возвращаются быстро.</p><div class="code_responsive"><pre class="programlisting">s.ReadAsyncMode = 'continuous';
fprintf(s,'*IDN?')
s.BytesAvailable
ans =
    56
out = fscanf(s);</pre></div><p>Если <code class="literal">ReadAsyncMode</code> является <code class="literal">manual</code>, объект последовательного порта постоянно не запрашивает устройство, чтобы определить, доступны ли данные, чтобы быть считанными. Чтобы считать данные асинхронно, используйте функцию <a href="../ref/readasync.html"><code class="function">readasync</code></a>. Затем используйте одну из синхронных функций чтения, чтобы передать данные от входного буфера до MATLAB.</p><div class="code_responsive"><pre class="programlisting">s.ReadAsyncMode = 'manual';
fprintf(s,'*IDN?')
s.BytesAvailable
ans =
    0
readasync(s)
s.BytesAvailable
ans =
    56
out = fscanf(s);</pre></div><p>Асинхронные операции не блокируют доступ к командной строке MATLAB. Кроме того, в то время как асинхронная операция чтения происходит, вы можете:</p><div class="itemizedlist"><ul><li><p>Выполните асинхронную операцию записи, потому что последовательные порты имеют отдельные контакты для чтения и записи</p></li><li><p>Используйте все поддерживаемые свойства обратного вызова</p></li></ul></div><p>Чтобы определить, какие асинхронные операции происходят, используйте свойство <code class="literal">TransferStatus</code>. Если никакие асинхронные операции не происходят, то <code class="literal">TransferStatus</code> является <code class="literal">idle</code>.</p><div class="code_responsive"><pre class="programlisting">s.TransferStatus
ans =
idle</pre></div><p><strong id="f98237">Правила для Завершения Операции чтения с fscanf.&nbsp;&nbsp;</strong>Операция чтения с <code class="function">fscanf</code> блокирует доступ к командной строке MATLAB до:</p><div class="itemizedlist"><ul><li><p><code class="literal">Считался терминатор строки, заданный как свойство Terminator.</code></p></li><li><p><code class="literal">Прошло время, заданное как свойство Timeout.</code></p></li><li><p>Конкретное количество заданных значений читается.</p></li><li><p>Входной буфер заполнен.</p></li></ul></div></section><section itemprop="content"><h4 class="title" id="f72926">Чтение двоичных данных</h4><a class="indexterm" name="d120e80649"></a><a class="indexterm" name="d120e80654"></a><a class="indexterm" name="d120e80659"></a><p>Вы используете функцию <a href="../ref/serial.fread.html"><code class="function">fread</code></a>, чтобы считать двоичные данные из устройства. Чтение двоичных данных означает, что вы возвращаете численные значения к MATLAB.</p><p>Например, предположите, что вы хотите возвратить курсор и настройки отображения для осциллографа. Это требует записи <code class="literal">CURSOR?</code> и команд <code class="literal">DISPLAY?</code> к инструменту, и затем чтение поддерживает результаты тех команд.</p><div class="code_responsive"><pre class="programlisting">s = serial('COM1');
fopen(s)
fprintf(s,'CURSOR?')
fprintf(s,'DISPLAY?')</pre></div><p>Поскольку значением по умолчанию для свойства <code class="literal">ReadAsyncMode</code> является <code class="literal">continuous</code>, данные асинхронно возвращен во входной буфер, как только это доступно от устройства. Чтобы проверить количество чтения значений, используйте свойство <code class="literal">BytesAvailable</code>.</p><div class="code_responsive"><pre class="programlisting">s.BytesAvailable
ans =
    69</pre></div><p>Чтобы возвратить данные в MATLAB, используйте любую из синхронных функций чтения. Однако, если вы используете <code class="function">fgetl</code>, <code class="function">fgets</code> или <code class="function">fscanf</code>, необходимо выпустить функцию дважды, потому что существует два терминатора строки, сохраненные во входном буфере. Чтобы возвратить все данные в MATLAB в одном вызове функции, используйте <code class="function">fread</code>.</p><div class="code_responsive"><pre class="programlisting">out = fread(s,69);</pre></div><p>По умолчанию <a href="../ref/serial.fread.html"><code class="function">fread</code></a> возвращает численные значения в массивах двойной точности. Однако можно задать много другой точности, как описано на страницах с описанием <code class="function">fread</code>. Чтобы преобразовать числовые данные в текст, используйте функцию <a href="../ref/char.html"><code class="function">char</code></a> MATLAB.</p><div class="code_responsive"><pre class="programlisting">val = char(out)'
val =
HBARS;CH1;SECONDS;-1.0E-3;1.0E-3;VOLTS;-6.56E-1;6.24E-1
YT;DOTS;0;45</pre></div><p>Для получения дополнительной информации о синхронных и асинхронных операциях чтения, смотрите <a href="writing-and-reading-data.html#f123662" class="intrnllnk">текстовые Данные Чтения</a>. Для описания правил<a href="../ref/serial.fread.html"><code class="function">, использованных fread</code></a>, чтобы завершить операцию чтения, обратитесь к ее страницам с описанием.</p></section></section><section itemprop="content"><h3 class="title" id="f63007">Пример - пишущие и считывающие текстовые данные</h3><p>Этот пример иллюстрирует, как связаться с инструментом последовательного порта путем записи и чтения текстовых данных.</p><p>Инструмент является Tektronix TDS 210 двухканальный осциллограф, соединенный с портом COM1. Поэтому многие следующие команды характерны для этого инструмента. Синусоида вводится в канал 2 из осциллографа, и ваше задание должно измерить напряжение от пика к пику входного сигнала.</p><div class="orderedlist"><ol style="list-style: decimal;"><li><p id="f115877">Создайте объект последовательного порта — Создают объект последовательного порта <code class="literal">s</code>, сопоставленный с последовательным портом COM1.</p><div class="code_responsive"><pre class="programlisting">s = serial('COM1');</pre></div></li><li><p id="f89103dfi6">Соединитесь с устройством — Подключение <code class="literal">s</code> к осциллографу. Поскольку значением по умолчанию для свойства <code class="literal">ReadAsyncMode</code> является <code class="literal">continuous</code>, данные асинхронно возвращен во входной буфер, как только это доступно от инструмента.</p><div class="code_responsive"><pre class="programlisting">fopen(s)</pre></div></li><li><p id="f88972">Запишите и считайте данные — Запись команда <code class="literal">*IDN?</code> к инструменту с помощью <a href="../ref/serial.fprintf.html"><code class="function">fprintf</code></a>, и затем считайте назад результат команды с помощью <a href="../ref/serial.fscanf.html"><code class="function">fscanf</code></a>.</p><div class="code_responsive"><pre class="programlisting">fprintf(s,'*IDN?')
idn = fscanf(s)
idn =
TEKTRONIX,TDS 210,0,CF:91.1CT FV:v1.16 TDS2CM:CMV:v1.04</pre></div><p>Необходимо определить источник измерения. Возможные источники измерения включают канал 1 и канал 2 из осциллографа.</p><div class="code_responsive"><pre class="programlisting">fprintf(s,'MEASUREMENT:IMMED:SOURCE?')
source = fscanf(s)
source =
CH1</pre></div><p>Осциллограф сконфигурирован, чтобы возвратить измерение в канал 1. Поскольку входной сигнал соединяется с каналом 2, необходимо сконфигурировать инструмент, чтобы возвратить измерение в этот канал.</p><div class="code_responsive"><pre class="programlisting">fprintf(s,'MEASUREMENT:IMMED:SOURCE CH2')
fprintf(s,'MEASUREMENT:IMMED:SOURCE?')
source = fscanf(s)
source =
CH2</pre></div><p>Сконфигурируйте осциллограф, чтобы возвратить напряжение от пика к пику, и затем запросить значение этого измерения.</p><div class="code_responsive"><pre class="programlisting">fprintf(s,'MEASUREMENT:MEAS1:TYPE PK2PK')
fprintf(s,'MEASUREMENT:MEAS1:VALUE?')</pre></div><p>Передайте данные от входного буфера до MATLAB с помощью <code class="function">fscanf</code>.</p><div class="code_responsive"><pre class="programlisting">ptop = fscanf(s,'%g')
ptop =
2.0199999809E0</pre></div></li><li><p id="f63034">Разъединитесь и очистите — Когда вам больше не нужен <code class="literal">s</code>, отключают его от инструмента и удаляют его из памяти и из MATLAB workspace.</p><div class="code_responsive"><pre class="programlisting">fclose(s)
delete(s)
clear s</pre></div></li></ol></div></section><section itemprop="content"><h3 class="title" id="f97378">Пример - Парсинг Входных данных Используя textscan</h3><p>Этот пример иллюстрирует, как использовать функцию <a href="../ref/textscan.html"><code class="function">textscan</code></a>, чтобы проанализировать и отформатировать данные, которые вы считываете из устройства. <code class="function">textscan</code> особенно полезен когда это необходимо, чтобы проанализировать строку в одну или несколько переменных, где каждая переменная имеет свой собственный заданный формат.</p><p>Инструмент является Tektronix TDS 210 двухканальный осциллограф, соединенный с последовательным портом COM1.</p><div class="orderedlist"><ol style="list-style: decimal;"><li><p id="f97381">Создайте объект последовательного порта — Создают объект последовательного порта <code class="literal">s</code>, сопоставленный с последовательным портом COM1.</p><div class="code_responsive"><pre class="programlisting">s = serial('COM1');</pre></div></li><li><p id="f97383">Соединитесь с устройством — Подключение <code class="literal">s</code> к осциллографу. Поскольку значением по умолчанию для свойства <code class="literal">ReadAsyncMode</code> является <code class="literal">continuous</code>, данные асинхронно возвращен во входной буфер, как только это доступно от инструмента.</p><div class="code_responsive"><pre class="programlisting">fopen(s)</pre></div></li><li><p id="f97385">Запишите и считайте данные — Запись команда <code class="literal">RS232?</code> к инструменту с помощью <a href="../ref/serial.fprintf.html"><code class="function">fprintf</code></a>, и затем считайте назад результат команды с помощью <a href="../ref/serial.fscanf.html"><code class="function">fscanf</code></a>. <code class="literal">RS232?</code> запрашивает настройки RS-232 и возвращает скорость в бодах, установку программного управления потоком, установку аппаратного управления потоками, тип контроля четности и терминатор строки.</p><div class="code_responsive"><pre class="programlisting">fprintf(s,'RS232?')
data = fscanf(s)
data =
9600;0;0;NONE;LF</pre></div><p>Используйте функцию <a href="../ref/textscan.html"><code class="function">textscan</code></a>, чтобы проанализировать и отформатировать переменную <code class="literal">data</code> в пять новых переменных.</p><div class="code_responsive"><pre class="programlisting">C = textscan(a, '%d%d%d%s%s','delimiter',';');

[br, sfc, hfc, par, tm] = deal(C{:});

br =
        9600
sfc =
     0
hfc =
     0
par =
    'NONE'
tm =
    'LF'</pre></div></li><li><p id="f97705">Разъединитесь и очистите — Когда вам больше не нужен <code class="literal">s</code>, необходимо отключить его от инструмента и удалить его из памяти и из MATLAB workspace.</p><div class="code_responsive"><pre class="programlisting">fclose(s)
delete(s)
clear s</pre></div></li></ol></div></section><section itemprop="content"><h3 class="title" id="f97373">Пример - считывающий двоичные данные</h3><p>Этот пример показывает как вы, чтобы загрузить отображение на экране осциллографа TDS 210 на MATLAB. Данные отображения на экране передаются и сохранили использование на диск растрового формата Windows. Это данные обеспечивают постоянную запись вашей работы и являются простым способом зарегистрировать важный сигнал и параметры осциллографа.</p><p>Поскольку переданный объем данных, как ожидают, будет довольно большим, он асинхронно возвращен во входной буфер, как только это доступно от инструмента. Это позволяет вам выполнять другие задачи, в то время как передача прогрессирует. Кроме того, осциллограф сконфигурирован к его самой высокой скорости в бодах 19 200.</p><div class="orderedlist"><ol style="list-style: decimal;"><li><p id="f89935">Создайте объект последовательного порта — Создают объект последовательного порта <code class="literal">s</code>, сопоставленный с последовательным портом COM1.</p><div class="code_responsive"><pre class="programlisting">s = serial('COM1');</pre></div></li><li><p id="f90135">Сконфигурируйте значения свойств — Конфигурируют входной буфер, чтобы принять довольно большое количество байтов и сконфигурировать скорость в бодах к самому высокому значению, поддержанному осциллографом.</p><div class="code_responsive"><pre class="programlisting">s.InputBufferSize = 50000;
s.BaudRate = 19200;</pre></div></li><li><p id="f89616">Соединитесь с устройством — Подключение <code class="literal">s</code> к осциллографу. Поскольку значением по умолчанию для свойства <code class="literal">ReadAsyncMode</code> является <code class="literal">continuous</code>, данные асинхронно возвращен во входной буфер, как только это доступно от инструмента.</p><div class="code_responsive"><pre class="programlisting">fopen(s)</pre></div></li><li><p id="f90171">Запишите и считайте данные — Конфигурируют осциллограф, чтобы передать отображение на экране как битовый массив.</p><div class="code_responsive"><pre class="programlisting">fprintf(s,'HARDCOPY:PORT RS232')
fprintf(s,'HARDCOPY:FORMAT BMP')
fprintf(s,'HARDCOPY START')</pre></div><p>Ожидайте, пока все данные не отправляются во входной буфер, и затем передайте данные MATLAB workspace как 8-битные целые числа без знака.</p><div class="code_responsive"><pre class="programlisting">out = fread(s,s.BytesAvailable,'uint8');</pre></div></li><li><p id="f115927">Разъединитесь и очистите — Когда вы больше не будете нуждаться <code class="literal">в s</code>, будете отключать его от инструмента и удалять его из памяти и из MATLAB workspace.</p><div class="code_responsive"><pre class="programlisting">fclose(s)
delete(s)
clear s</pre></div></li></ol></div><section itemprop="content"><h4 class="title" id="f97208">Просмотр растровых данных</h4><p>Чтобы просмотреть растровые данные, выполните эти шаги:</p><div class="orderedlist"><ol style="list-style: decimal;"><li><p id="f99022">Откройте дисковый файл.</p></li><li><p id="f99307">Запишите данные в дисковый файл.</p></li><li><p id="f99318">Закройте дисковый файл.</p></li><li><p id="f97214">Считайте данные в MATLAB с помощью функции <a href="../ref/imread.html"><code class="function">imread</code></a>.</p></li><li><p id="f97235">Масштабируйте и отобразите данные с помощью функции <a href="../ref/imagesc.html"><code class="function">imagesc</code></a>.</p></li></ol></div><p>Обратите внимание на то, что версии файлового ввода-вывода <a href="../ref/serial.fopen.html"><code class="function">fopen</code></a>, <a href="../ref/serial.fwrite.html"><code class="function">fwrite</code></a> и функций <a href="../ref/serial.fclose.html"><code class="function">fclose</code></a> используются.</p><div class="code_responsive"><pre class="programlisting">fid = fopen('test1.bmp','w');
fwrite(fid,out,'uint8');
fclose(fid)
a = imread('test1.bmp','bmp');
imagesc(a)</pre></div><p>Поскольку осциллограф возвращает данные отображения на экране с помощью только двух цветов, соответствующая палитра выбрана.</p><div class="code_responsive"><pre class="programlisting">mymap = [0 0 0; 1 1 1];
colormap(mymap)</pre></div><p>Следующая схема показывает изображение полученного растрового изображения.</p><div class="informalfigure"><div id="d120e81014" class="mediaobject"><p><img src="serialhc.gif" alt="" height="322" width="369"></img></p></div></div></section></section></section>
          </div><div class="clearfix"></div>
            <div class="feedbackblock">Была ли эта тема полезной? <input type="button" value="Да" onClick="openFeedbackWindow('https://www.mathworks.com/programs/bounce_hub_help.html?s_cid=Help_Topic_Survey&amp;surveyParams='+document.location.href+'-YES-R2018b');"></input>
              <input type="button" value="Нет" onClick="openFeedbackWindow('https://www.mathworks.com/programs/bounce_hub_help.html?s_cid=Help_Topic_Survey&amp;surveyParams='+document.location.href+'-NO-R2018b');"></input>
            </div>
          </section>

          <!--Last updated: Thu Aug 23 06:03:58 EDT 2018-->
        </div>
      </div>
    </div><!--close_0960-->
  </div><!--close_0970-->
  <div xmlns="http://www.w3.org/1999/xhtml" class="body_trail_container">
    <div class="container-fluid">
      <div class="row">
        <div class="col-xs-12">
          <div class="row"><div class="col-xs-12 col-sm-3"><h5><a href="../index.html?s_cid=doc_ftr">Документация MATLAB</a></h5>
            <ul class="list-unstyled hidden-xs"><li><a href="../examples.html?s_cid=doc_ftr">Примеры</a></li>
              <li><a href="../referencelist.html?type=function&amp;s_cid=doc_ftr">Функции</a></li>
              <li><a href="../release-notes.html?s_cid=doc_ftr">Информация о релизах</a></li>
              <li><a href="https://www.mathworks.com/help/releases/R2018b/pdf_doc/matlab/index.html?s_cid=doc_ftr">PDF-документация</a></li>
            </ul>
          </div>
            <div class="col-xs-12 col-sm-3"><h5><a href="https://www.mathworks.com/support.html?s_cid=doc_ftr">Поддержка</a></h5>
              <ul class="list-unstyled hidden-xs"><li><a href="https://www.mathworks.com/matlabcentral/answers/index?s_cid=doc_ftr">MATLAB Answers</a></li><li><a href="https://www.mathworks.com/support/install-matlab.html?s_cid=doc_ftr">Помощь в установке</a></li><li><a href="https://www.mathworks.com/support/bugreports/?s_cid=doc_ftr">Отчеты об ошибках</a></li><li><a href="https://www.mathworks.com/products/availability.html?s_cid=doc_ftr">Требования к продукту</a></li><li><a href="https://www.mathworks.com/downloads/?s_cid=doc_ftr">Загрузка программного обеспечения</a></li></ul>
            </div>
          </div>
        </div>
      </div>
    </div><!--END.CLASS container-fluid-->
  </div><!--END.CLASS body_trail_container-->
  <footer xmlns="http://www.w3.org/1999/xhtml" id="footer" class="bs-footer">
    <div class="container-fluid">
      <div class="footer">
        <div class="row">
          <div class="col-xs-12">
            <p class="copyright">© 1994-2018 The MathWorks, Inc.</p>
            <ul class="footernav"><li class="footernav_help"><a href="MATLAB:web(matlab.internal.licenseAgreement)">Условия использования</a></li><li class="footernav_patents"><a href="MATLAB:web([matlabroot '/patents.txt'])">Патенты</a></li><li class="footernav_trademarks"><a href="MATLAB:web([matlabroot '/trademarks.txt'])">Торговые марки</a></li><li class="footernav_piracy"><a href="MATLAB:web([docroot '/acknowledgments.html'])">Список благодарностей</a></li></ul></div>
        </div>
      </div>
    </div>
  </footer>
</div><!--close row-offcanvas-->
</body>
</html>
